Imports System.Console
Module Module1
    Dim TextLine As String
    Dim allElements() As String
    Dim currentLine As String
    Sub Main()
        'part1()
        part2()
        ReadKey()
    End Sub
    Sub part1()
        Dim gammaRate As String = ""
        Dim epsilonRate As String = "" 'most common and least common bits
        Dim firstLine As String = ""
        Dim count1s, count0s As Integer
        Dim FILE_NAME As String = "N:\ADVENTOFCODEDAY3.txt"


        If System.IO.File.Exists(FILE_NAME) = True Then
            For i = 0 To 11
                firstLine = ""
                count1s = 0
                count0s = 0
                Dim objReader As New System.IO.StreamReader(FILE_NAME)
                Do While objReader.Peek() <> -1
                    TextLine = objReader.ReadLine() & vbNewLine
                    firstLine += TextLine.Chars(0 + i)
                Loop
                WriteLine(firstLine)
                For Each item As String In firstLine
                    If item = "1" Then
                        count1s += 1
                    Else
                        count0s += 1
                    End If
                Next
                If count1s > count0s Then
                    gammaRate += "1"
                    epsilonRate += "0"
                ElseIf count0s > count1s Then
                    gammaRate += "0"
                    epsilonRate += "1"
                Else
                    WriteLine("There has been an error in calculation")
                End If
            Next
           

            Dim gammaAsInt As Integer = Convert.ToInt32(gammaRate, 2)
            Dim epsilonAsInt As Integer = Convert.ToInt32(epsilonRate, 2)
            WriteLine("Gamma: {0} or {1}", gammaRate, gammaAsInt)
            WriteLine("Epsilon: {0} or {1}", epsilonRate, epsilonAsInt)
            WriteLine("Power Consumption: {0}", gammaAsInt * epsilonAsInt)
        Else
            WriteLine("File Does Not Exist")
        End If
    End Sub
